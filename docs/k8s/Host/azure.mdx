---
pagination_prev:
pagination_next:
title: Setup Azure VM
---

:::info Prerequisites
You'll need to have rights to create and modify virtual machines.
:::

## Login to Azure Portal

Click [here](https://portal.azure.com/#cloudshell) to login to Azure and open a cloud shell.

**Either:** select "Powershell" as the terminal type **-or-** ensure Powershell is selected at the top of the terminal window.  
![azure ps](/img/powershell.png)

Switch into your cloud drive so anything you download and run will persist from session to session.

```bash
cd ~/clouddrive
```

## Download the helper script

This script lets you pick a subscription, creates a unique resource group for you (critical if others running this tutorial in the same subscription), and provides common commands.

Download the helper script:

```bash
curl https://www.suchcodewow.io/manifests/helper.ps1 > ~/clouddrive/helper.ps1
```

## Create the virtual machine

:::warning Check your subscription!
Your shell is connected to a subscription. When you create resources (groups/vm's/etc) in Azure, by default, they will be created in your current subscription.

Ensure that you are connected to the correct subscription using the helper script below.

:::

Run the helper script to setup your resource group and add a vm to it.

:::Warning Azure Passwords!
You'll need to think up a fairly saucy password for your VM. As of this writing:

- Passwords must be 12 characters long.
- Have 3 out of 4: lower case, upper case, digit, special character
  :::

```bash
~/clouddrive/helper.ps1
```

The (name) below comes from the email address of your Azure account up to the '@' symbol. i.e. bob.smith@mail.com would be 'bob.smith'.

The script:

1. allows you to select a subscription (and set it as default).
1. [creates a resource group](https://docs.microsoft.com/en-us/cli/azure/group?view=azure-cli-latest) in the format: scw-group-(name).
1. [creates a vm](https://docs.microsoft.com/en-us/cli/azure/vm?view=azure-cli-latest#az-vm-create) in that resource group with the format: scw-host-(name).
1. saves the public IP of your vm into the _myip_ file.

:::tip Showing the commands
By default, the helper script shows each command as it runs so you can see what it is doing if you are new to Azure. It can be turned off be editing helper.ps1 and changing `$show_commands = $true` to `$show_commands = $false` near the top.
:::

Details on the create vm step:

- We're using the long term support (LTS) version of Ubuntu linux for the **image**.
- The **- - size Standard_B2ms** is a good combination of price and a large enough host (2cpu & 8gb mem) to run kubernetes.
- **public-ip-sku** assigns a public IP address so we can access our machine remotely.

Once the script presents you with additional options, it's safe to press < enter > and quit. You can run the helper script at any point going forward- it will skip passed the creation steps and take you directly to the help options.

Copy the **myip** file into your host to reference later.

> Type `yes` (if asked) to store the key fingerprint.  
> Enter the password of your new vm when needed.

:::tip azureuser
The username IS in fact, by default, azureuser. No need to change it below! You didn't miss anything.
:::

```bash
scp myip azureuser@$(cat myip):/home/azureuser/myip
```

## :checkered_flag: Checkpoint

Run the helper script:

```bash
~/clouddrive/helper.ps1
```

Once it loads, you'll see options to quickly login to your Azure VM or reset the password. It also shows you the exact command it runs to perform those steps if you want to copy them out to use later.

If you successfully login, congratulations! You've configured your host.

## Next Steps

Check out the next numbered item on the left sidebar for more.
