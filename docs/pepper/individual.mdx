---
sidebar_position: 1
---

# Azure & Dynatrace: Initial Setup

Welcome to the Azure & Dynatrace 2024 Hot session!  
We'll be playing several common roles today the fictional organization of "Dynabank". Below are suggestions on tabs to keep open.

You have multiple logins!

- Dynatrace University (your existing login)
- Azure Portal login (classX@suchcodewow.io)
- Dynatrace login (attendee#@dynatracelabs.com)

## Setup Confirmation/Recommendations

### Tab 1: Dynatrace University with terminal (Hot Attendee)

Use the email and password you use to login to Dynatrace University.

#### Azure Terminal

When you start the University terminal, you'll need to run the following command to connect it to your Azure login.

```bash
az login
```

#### Pepper

While at the command line, run Pepper:

```bash
curl https://www.suchcodewow.io/manifests/pepper.ps1 > ~/pepper.ps1 && pwsh ~/pepper.ps1 -c
```

Pepper will take an inventory of what is loaded. Confirm:

| Component        | Name                                        |
| ---------------- | ------------------------------------------- |
| Resource group   | scw-group-[classname]                       |
| AKS cluster      | scw-AKS-[classname]                         |
| App Service Plan | scw-ASP-[classname]                         |
| Web App          | scw-webapp-[classname]                      |
| Dynatrace        | tenant shown in University & 5/5 pods ready |

We'll use Pepper at several points during the session. You can leave it running. If you do exit, you can use 'up-arrow' to recall the command.  
Or you can just copy and paste from above into your terminal again.

### Tab 2: This guide (Hot Attendee)

You're already here. You did it!

### Tab 3: Azure Portal (Enterprise Cloud Operations)

Confirm login to [Azure portal](https://portal.azure.com) with [classname]@suchcodewow.io. Password provided in University.

You can check out the resource pre-deployed for you. They are listed below. For example, if you search for 'resource group' in the top bar of Azure, you can find your resource group.

Resources created:

| Component        | Name                   |
| ---------------- | ---------------------- |
| Resource group   | scw-group-[classname]  |
| AKS cluster      | scw-AKS-[classname]    |
| App Service Plan | scw-ASP-[classname]    |
| Web App          | scw-webapp-[classname] |

### Tab 4: Dynatrace (Dynatrace Administrator)

Login to Dynatrace tenant using URL, class name, password. Provided in class spreadsheet.

Confirm that Dynatrace is connected to your Azure resources & make the following updates.

1. Open the "Apps" page.
1. Click Kubernetes (not the "new" one).
1. Check that you see a cluster running similar to "k8s[classname]".

#### Logs

1. Go to Settings -> Log Monitoring -> Log Ingest Rules.
1. Toggle on [Built-in] Ingest all logs then click _Save changes_ bottom left of screen.

#### Bizevents

1. Go to Settings -> Preferences -> OneAgent features.
1. In the Filter by box, type `business event` and press ENTER: ![bizevent1](/img/bizevent1.png)
1. Toggle ON _Business Event [Opt-in]_ for .NET, Go, Java, Node.js, and Webserver. Select the drop-down arrow for each and toggle ON _Instrucmentation enabled_.
1. Click _Save Changes_ bottom left of screen.
1. Go to Settings -> Business Analytics -> OneAgent.
1. Click _App new capture rule_ and name it 'AllEvents'.
1. Click _Add trigger_ and set the following values:

| Key         | Value          |
| ----------- | -------------- |
| Data Source | Request - Path |
| Operator    | exists         |

![bizevents2](/img/bizevents2.png)

1. In the _Event meta data_ section, set the following values:

| Key                         | Value          |
| --------------------------- | -------------- |
| Event provider: Data Source | Fixed Value    |
| Event provider: Fixed Value | AzureHoT       |
| Event type: Data source     | Request - Path |
| Event type: Event category  | Fixed Value    |
| Event type: Fixed Value     | Request - Path |

1. In the _Event data_ section, click _Add data field_, and then set the following values:

| Key         | Value                             |
| ----------- | --------------------------------- |
| Field name  | params                            |
| Data source | Request - Query String parameters |
| Path        | \*                                |

1. Click _Add data field_ again and then set the following values:

| Key         | Value           |
| ----------- | --------------- |
| Field name  | responsebody    |
| Data source | Response - Body |
| Path        | \*              |

1. Click _Save changes_ in the bottom left.
